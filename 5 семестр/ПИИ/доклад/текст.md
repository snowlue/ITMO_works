# Доклад по ПИИ
## 1. Титульный слайд
Здравствуйте, сегодня я расскажу вам о современных подходах к синтезу речи и объясню, как они развивались с течением времени. Мы разберем два основных метода: Unit Selection и параметрический синтез, а также рассмотрим на примере Т-Банка, как современные компании используют эти технологии.

## 2. Слайд: Что такое синтез речи?
Синтез речи — это процесс создания звука на основе текста. Существует два основных подхода: Unit selection или конкатенативный подход, который работает на основе склейки записанных фрагментов речи, и параметрический синтез, создающий речь на основе математической модели, предсказывающей акустические признаки текста.

Речь моделей unit selection имеет высокое качество, низкую вариативность и требует большого объема данных для обучения. С конца 90-х долгое время он считался де-факто стандартом для разработки движков синтеза речи. Например, голос, звучащий по методу unit selection, можно было встретить в Siri.
В то же время для тренировки параметрических моделей необходимо гораздо меньшее количество данных, они генерируют более разнообразные интонации, но до недавнего времени страдали от общего достаточно низкого качества звука по сравнению с подходом unit selection.

## 3. Слайд: Метрики качества синтеза речи
Прежде чем говорить о том, какие модели синтеза речи лучше, нужно определить метрики качества, по которым будет проводиться сравнение алгоритмов.

Поскольку один и тот же текст можно прочитать бесконечным количеством способов, априори правильного способа для произношения конкретной фразы не существует. Поэтому зачастую метрики качества синтеза речи субъективны и зависят от восприятия слушающего.

Стандартная метрика — это MOS (mean opinion score), усредненная оценка естественности речи, выданная асессорами для синтезированных аудио по шкале от 1 до 5. Единица означает совсем неправдоподобное звучание, а пятерка — речь, неотличимую от человеческой. Реальные записи людей обычно получают значения примерно 4,5, и значение больше 4 считается достаточно высоким.

Первый шаг к построению любой системы синтеза речи — сбор данных для обучения. Обычно это аудиозаписи высокого качества, на которых диктор читает специально подобранные фразы. Примерный размер датасета, необходимый для обучения моделей unit selection, составляет 10—20 часов чистой студийной речи, в то время как для нейросетевых параметрических методов верхняя оценка равна примерно 25 часам.

## 4. Слайд: Unit Selection
Обычно записанная речь диктора не может покрыть всех возможных случаев, в которых будет использоваться синтез. Поэтому суть метода состоит в разбиении всей аудиобазы на небольшие фрагменты, называющиеся юнитами, которые затем склеиваются друг с другом с использованием минимальной постобработки. В качестве юнитов обычно выступают минимальные акустические единицы языка, такие как полуфоны или дифоны.

Весь процесс генерации состоит из двух этапов: NLP frontend, отвечающий за извлечение лингвистического представления текста, и backend, который вычисляет функцию штрафа юнитов для заданных лингвистических признаков. В NLP frontend входят:

1. Задача нормализации текста — перевод всех небуквенных символов (цифр, знаков процентов, валют и так далее) в их словесное представление. Например, “5 %” должно быть переведено в “пять процентов”.
2. Извлечение лингвистических признаков из нормализованного текста: фонемное представление, ударения, части речи и так далее.

Обычно NLP frontend реализован с помощью вручную прописанных правил для конкретного языка, однако в последнее время происходит все больший уклон в сторону использования моделей машинного обучения.

Штраф, оцениваемый backend-подсистемой, — это сумма target cost, или соответствия акустического представления юнита для конкретной фонемы, и concatenation cost, то есть уместности соединения двух соседних юнитов. Для оценки штраф функций можно использовать правила или уже обученную акустическую модель параметрического синтеза. Выбор наиболее оптимальной последовательности юнитов с точки зрения выше определенных штрафов происходит с помощью алгоритма Витерби.

Примерные значения MOS моделей unit selection для английского языка: 3,7—4,1.

[[Рассказать про достоинства и недостатки со слайда]]

## 5. Слайд: Параметрический синтез
В основе параметрического подхода лежит идея о построении вероятностной модели, которая предсказывает акустические признаки заданного текста.

Процесс генерации речи в параметрическом синтезе можно разделить на четыре этапа:

1. NLP frontend — такая же стадия предобработки данных, как и в подходе unit selection, результат которой — большое количество контекстно-зависимых лингвистических признаков.
2. Duration model, предсказывающая длительность фонем.
3. Акустическая модель, восстанавливающая распределение акустических признаков по лингвистическим. В акустические признаки входят значения фундаментальной частоты, спектральное представление сигнала и так далее.
4. Вокодер, переводящий акустические признаки в звуковую волну.

Примерные значения MOS для нейросетевых методов: 4,4—4,5, то есть синтезируемая речь практически не отличается от человеческой.

[[Рассказать про достоинства и недостатки со слайда]]

## 6. Слайд: Пример реализации Т-Банка
Как следует из обзора, методы параметрического синтеза речи, основанные на нейросетях, превосходят по качеству подход unit selection и гораздо проще для разработки. Поэтому Т-Банк использует именно их для построения собственного движка синтеза речи.
Чтобы обучить модель, использовали около 25 часов чистой речи профессионального диктора. Тексты для чтения были специально подобраны так, чтобы наиболее полно покрыть фонетику разговорной речи. Кроме того, чтобы добавить синтезу большее разнообразие в интонации, сотрудники попросили диктора читать тексты с выражением, зависящим от контекста.

Архитектура решения концептуально выглядит так:

1. NLP frontend, в который входит нейросетевая текстовая нормализация и модель по расстановке пауз и ударений.
2. Tacotron 2, принимающий на вход буквы.
3. Авторегрессионный WaveNet, работающий в real time на CPU.

Благодаря такой архитектуре движок генерирует выразительную речь высокого качества в режиме реального времени, не требует построения фонемного словаря и дает возможность управлять ударениями в отдельных словах. Примеры синтезированных аудио ранее были доступны на сайте ex Тинькофф, но теперь их в сети не найти, к сожалению.